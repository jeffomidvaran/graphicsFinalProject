<!DOCTYPE HTML> 
<html lang="en"> 
<head>
	<title>Final Project </title>
	<style>
		body {
			background-color: #EEEEEE;
		}
		label {
			white-space: pre;
		}
	</style>
	<meta charset="utf-8"> 


	<!-- VERTEX SHADER  -->
	<script type="x-shader/x-vertex" id="vshader-source" >
		attribute vec3 a_coords;
		attribute vec3 a_normal;
		attribute vec3 a_color;

		uniform mat4 modelview;
		uniform mat4 projection;

		uniform mat3 normalMatrix;
		uniform vec4 lightPosition;

		uniform vec4 diffuseColor;
		uniform vec3 specularColor;
		uniform float specularExponent;

		varying vec4 v_color;

		varying vec3 v_normal; 

		void main(){

			vec4 coords = vec4(a_coords,1.0);
			vec4 eyeCoords = modelview * coords;
			gl_Position = projection * eyeCoords;

			// #######################################################################
			// ######## DEFINE N,L,R,V ############################################### 
			// #######################################################################
			vec3 N, L, R, V;  

			N = normalize( normalMatrix * a_normal );

			if ( lightPosition.w == 0.0 ) {
				L = normalize( lightPosition.xyz );
			}
			else {
				L = normalize( lightPosition.xyz/lightPosition.w - eyeCoords.xyz );
			}

			R = -reflect(L,N);
			V = normalize( -eyeCoords.xyz);   
			

			// #######################################################################
			// ############## Lighting ############################################### 
			// #######################################################################

			
			
			float ka = 0.3;  // ambient intensity
			float kd = 0.8;  // diffuse intensity
			float ks = 0.4;  // spectral intensity 
			vec4 ambientLight = ka * diffuseColor;
			vec4 diffuseLight = kd * diffuseColor * max(dot(N,L), 0.0); 

			vec4 specularLight= ks * 
                                vec4(specularColor.xyz, 1) * 
                                pow(max(dot(R,V), 0.0), specularExponent); 

			v_color = vec4(a_color * vec3(0.6,0.6,0.6), 1) + ambientLight + diffuseLight + specularLight;



			v_normal = a_normal; 

		}
	</script>
	

	<script type="x-shader/x-fragment" id="fshader-source" >
		#ifdef GL_FRAGMENT_PRECISION_HIGH
			precision highp float;
		#else
			precision mediump float;
		#endif


		varying vec4 v_color;
		varying vec3 v_normal; 

		uniform vec3 u_reverseLightDirection; 
		uniform vec4 u_color; 


		void main() {

			vec3 normal = normalize(v_normal); 
			float light = dot(normal, u_reverseLightDirection); 
			gl_FragColor = u_color; 

			gl_FragColor.rgb *= light; 



			
			// gl_FragColor = v_color;
		}
	</script>

	<script src="gl-matrix-min.js"></script> 
	<script type="text/javascript" src="webgl-utils.js"></script>
	<script src="trackball-rotator.js"></script>
	<script src="models.js"></script>   
	<script src="finalProject.js"></script>   


</head>


<body onload="init();">
	<form id="input_form">
		<fieldset>
			Name: Jeffrey Omidvaran <br/>
			Student ID: 32332249 <br/>
		</fieldset>
	</form>
	<div id="canvas-holder"> </div>
		<canvas id="myGLCanvas" width="1400" height="1400"></canvas>
	</div>
</body>
</html>
